<div class="configuration-page">
  <div class="configuration-page_title">Train the new model here:</div>

  <div class="configuration-page_content">
    <div class="configuration-page_left-content">
      <div *ngIf="!recreateActionsButton" class="direction-container">
        <span>Direction: </span>
        <mat-icon *ngIf="lastKeyPressed === 'ArrowLeft'" class="direction-icon"
          >arrow_back</mat-icon
        >
        <mat-icon *ngIf="lastKeyPressed === 'ArrowRight'" class="direction-icon"
          >arrow_forward</mat-icon
        >
        <mat-icon *ngIf="lastKeyPressed === 'ArrowUp'" class="direction-icon"
          >arrow_upward</mat-icon
        >
        <mat-icon *ngIf="lastKeyPressed === 'ArrowDown'" class="direction-icon"
          >arrow_downward</mat-icon
        >
      </div>
      <div *ngIf="recreateActionsButton" class="direction-container">
        <span>Recreating the last record </span>
      </div>
      <div
        class="board"
        tabindex="0"
        [style.width.px]="
          ['0', '00', ''].includes(boardWidth) ? '800' : boardWidth
        "
        [style.height.px]="
          ['0', '00', ''].includes(boardHeight) ? '600' : boardHeight
        "
        (click)="addObstacle($event)"
      >
        <div class="robot" [style.left.px]="posX" [style.top.px]="posY"></div>
        <div
          *ngFor="let obstacle of obstacles"
          class="obstacle"
          [style.left.px]="obstacle.x"
          [style.top.px]="obstacle.y"
          [style.width.px]="obstacle.width"
          [style.height.px]="obstacle.height"
          (click)="handleObstacleClick($event, obstacle)"
        ></div>
      </div>
    </div>
    <div *ngIf="step !== 0" class="configuration-page_right-content">
      <!-- MESSAGES -->
      <div *ngIf="step === 1" class="right-container_text">
        STEP 1: Set board dimensions
      </div>
      <div *ngIf="step === 2" class="right-container_text">
        STEP 2: Set robot
      </div>
      <div *ngIf="step === 3" class="right-container_text">
        STEP 3: Set obstacles
      </div>
      <div *ngIf="step === 4" class="right-container_text">
        STEP 4: Train model
      </div>

      <!-- OPTIONS FOR EVERY STEP -->
      <form class="form-container">
        <!-- BOARD SETTINGS -->
        <mat-form-field *ngIf="step === 1" class="right-container_form-field">
          <mat-label>Board width (px)</mat-label>
          <input
            matInput
            type="text"
            [(ngModel)]="boardWidth"
            name="boardWidth"
          />
        </mat-form-field>
        <mat-form-field *ngIf="step === 1" class="right-container_form-field">
          <mat-label>Board height (px)</mat-label>
          <input
            matInput
            type="text"
            [(ngModel)]="boardHeight"
            name="boardHeight"
          />
        </mat-form-field>

        <!-- ROBOT SETTINGS -->
        <mat-form-field *ngIf="step === 2" class="right-container_form-field">
          <mat-label>Step used by the robot to move</mat-label>
          <input
            matInput
            type="text"
            [(ngModel)]="stepValue"
            name="stepValue"
          />
        </mat-form-field>
        <button
          *ngIf="step === 2"
          mat-raised-button
          class="form-field-button"
          (click)="chooseStartingPoint()"
        >
          Choose starting point for robot
        </button>
        <button
          *ngIf="step === 2"
          mat-raised-button
          class="form-field-button"
          (click)="chooseStartingPoint()"
        >
          Choose finish point for robot
        </button>

        <!-- OBSTACLES SETTINGS -->
        <mat-form-field *ngIf="step === 3" class="right-container_form-field">
          <mat-label>Obstacle width (px)</mat-label>
          <input
            matInput
            type="text"
            [(ngModel)]="obstacleWidth"
            name="obstacleWidth"
          />
        </mat-form-field>
        <mat-form-field *ngIf="step === 3" class="right-container_form-field">
          <mat-label>Obstacle height (px)</mat-label>
          <input
            matInput
            type="text"
            [(ngModel)]="obstacleHeight"
            name="obstacleHeight"
          />
        </mat-form-field>

        <!-- TRAIN MODEL BUTTONS -->
        <button
          *ngIf="step === 4"
          mat-raised-button
          class="form-field-button"
          [disabled]="recreateActionsButton"
          (click)="startRecord()"
        >
          Start record
        </button>
        <button
          *ngIf="step === 4"
          mat-raised-button
          class="form-field-button"
          [disabled]="recreateActionsButton || !startRecordButton"
          (click)="stopRecord()"
        >
          Stop record
        </button>
        <button
          *ngIf="step === 4"
          mat-raised-button
          [disabled]="!stopRecordButton"
          class="form-field-button"
          (click)="recreateActions()"
        >
          Recreate actions
        </button>
      </form>

      <!-- OPTION BUTTON -->
      <div class="option-buttons">
        <button
          *ngIf="step !== 0"
          mat-raised-button
          color="warn"
          (click)="
            applyChanges(
              boardWidth,
              boardHeight,
              obstacleWidth,
              obstacleHeight,
              stepValue
            )
          "
        >
          Apply changes
        </button>

        <button
          *ngIf="step !== 0"
          mat-raised-button
          color="basic"
          (click)="backOption()"
        >
          Back
        </button>
      </div>
    </div>

    <!-- STEP BUTTONS -->
    <div *ngIf="step === 0" class="step-buttons">
      <button
        mat-raised-button
        color="accent"
        class="configuration_button"
        [disabled]="
          robotSettingsActive || obstaclesSettingsActive || trainModelActive
        "
        (click)="boardSettings()"
      >
        STEP 1: Board settings
      </button>
      <button
        mat-raised-button
        color="accent"
        class="configuration_button"
        [disabled]="
          boardSettingsActive || obstaclesSettingsActive || trainModelActive
        "
        (click)="robotSettings()"
      >
        STEP 2: Robot settings
      </button>
      <button
        mat-raised-button
        color="accent"
        class="configuration_button"
        [disabled]="
          boardSettingsActive || robotSettingsActive || trainModelActive
        "
        (click)="obstaclesSettings()"
      >
        STEP 3: Obstacles settings
      </button>
      <button
        mat-raised-button
        color="accent"
        class="configuration_button"
        [disabled]="
          boardSettingsActive || obstaclesSettingsActive || robotSettingsActive
        "
        (click)="trainModel()"
      >
        STEP 4: Train model
      </button>
    </div>
  </div>
</div>
